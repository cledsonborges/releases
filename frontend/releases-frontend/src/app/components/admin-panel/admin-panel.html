<div class="admin-container">
  <!-- Header -->
  <header class="admin-header">
    <div class="container">
      <div class="header-content">
        <div class="header-left">
          <h1>Painel Administrativo</h1>
          <p>Gerenciamento de Releases e Sistema</p>
        </div>
        <div class="header-right">
          <button class="btn btn-outline" (click)="goBack()">‚Üê Voltar ao Dashboard</button>
        </div>
      </div>
    </div>
  </header>

  <div class="container">
    <!-- Quick Actions -->
    <div class="quick-actions">
      <h2>A√ß√µes R√°pidas</h2>
      <div class="actions-grid">
        <button class="action-btn" (click)="showCreateReleaseForm()">
          <div class="action-icon">üì¶</div>
          <div class="action-text">
            <h3>Nova Release</h3>
            <p>Criar uma nova release</p>
          </div>
        </button>
        
        <button class="action-btn" (click)="initializeDatabase()">
          <div class="action-icon">üóÑÔ∏è</div>
          <div class="action-text">
            <h3>Inicializar BD</h3>
            <p>Configurar banco de dados</p>
          </div>
        </button>
        
        <button class="action-btn" (click)="manageSquads()">
          <div class="action-icon">üë•</div>
          <div class="action-text">
            <h3>Gerenciar Squads</h3>
            <p>Adicionar/editar squads</p>
          </div>
        </button>
        
        <button class="action-btn" (click)="viewReports()">
          <div class="action-icon">üìä</div>
          <div class="action-text">
            <h3>Relat√≥rios</h3>
            <p>Visualizar m√©tricas</p>
          </div>
        </button>
      </div>
    </div>

    <!-- Create Release Form -->
    <div class="create-release-section" *ngIf="showCreateForm">
      <div class="form-card">
        <div class="form-header">
          <h2>Criar Nova Release</h2>
          <button class="btn btn-secondary" (click)="hideCreateReleaseForm()">‚úï</button>
        </div>
        
        <form (ngSubmit)="createRelease()" #releaseForm="ngForm">
          <div class="form-grid">
            <div class="form-group">
              <label for="releaseName">Nome da Release *</label>
              <input
                type="text"
                id="releaseName"
                name="releaseName"
                [(ngModel)]="newRelease.release_name"
                required
                placeholder="Ex: Release v2.1.0"
              />
            </div>
            
            <div class="form-group">
              <label for="ambiente">Ambiente *</label>
              <select
                id="ambiente"
                name="ambiente"
                [(ngModel)]="newRelease.ambiente"
                required
              >
                <option value="">Selecione o ambiente</option>
                <option value="homolog">Homolog</option>
                <option value="alpha">Alpha</option>
                <option value="producao">Produ√ß√£o</option>
              </select>
            </div>
            
            <div class="form-group">
              <label for="status">Status *</label>
              <select
                id="status"
                name="status"
                [(ngModel)]="newRelease.status"
                required
              >
                <option value="">Selecione o status</option>
                <option value="em andamento">Em Andamento</option>
                <option value="conclu√≠do">Conclu√≠do</option>
                <option value="bloqueado">Bloqueado</option>
                <option value="concluido com bugs">Conclu√≠do com Bugs</option>
              </select>
            </div>
            
            <div class="form-group">
              <label for="slaHours">SLA (horas)</label>
              <input
                type="number"
                id="slaHours"
                name="slaHours"
                [(ngModel)]="newRelease.sla_duration_hours"
                min="1"
                max="168"
                placeholder="Ex: 24"
              />
            </div>
            
            <div class="form-group full-width">
              <label for="description">Descri√ß√£o</label>
              <textarea
                id="description"
                name="description"
                [(ngModel)]="newRelease.descricao"
                rows="3"
                placeholder="Descreva as principais funcionalidades desta release..."
              ></textarea>
            </div>
            
            <div class="form-group">
              <label>
                <input
                  type="checkbox"
                  name="releaseExclusiva"
                  [(ngModel)]="newRelease.release_exclusiva"
                />
                Release Exclusiva
              </label>
            </div>
            
            <!-- Se√ß√£o de Squads -->
            <div class="form-group full-width">
              <label>Squads Participantes</label>
              <div class="squads-selection">
                <div *ngIf="loadingSquads" class="loading-squads">
                  <div class="spinner-small"></div>
                  <span>Carregando squads...</span>
                </div>
                
                <div *ngIf="!loadingSquads && squads.length === 0" class="no-squads">
                  <p>Nenhuma squad dispon√≠vel. <a href="#" (click)="manageSquads()">Criar squads</a></p>
                </div>
                
                <div *ngIf="!loadingSquads && squads.length > 0" class="squads-grid">
                  <div 
                    *ngFor="let squad of squads" 
                    class="squad-item"
                    [class.selected]="isSquadSelected(squad.squad_id!)"
                    (click)="toggleSquadSelection(squad.squad_id!)"
                  >
                    <div class="squad-checkbox">
                      <input 
                        type="checkbox" 
                        [checked]="isSquadSelected(squad.squad_id!)"
                        (change)="toggleSquadSelection(squad.squad_id!)"
                      />
                    </div>
                    <div class="squad-info">
                      <h4>{{ squad.squad_name }}</h4>
                      <p *ngIf="squad.modulos && squad.modulos.length > 0">
                        M√≥dulos: {{ squad.modulos.join(', ') }}
                      </p>
                      <p *ngIf="squad.responsavel">
                        Respons√°vel: {{ squad.responsavel }}
                      </p>
                    </div>
                  </div>
                </div>
                
                <!-- Squads Selecionadas -->
                <div *ngIf="newRelease.squads_participantes && newRelease.squads_participantes.length > 0" class="selected-squads">
                  <h4>Squads Selecionadas ({{ newRelease.squads_participantes.length }})</h4>
                  <div class="selected-squads-list">
                    <span 
                      *ngFor="let squadId of newRelease.squads_participantes" 
                      class="selected-squad-tag"
                    >
                      {{ getSquadName(squadId) }}
                      <button type="button" (click)="toggleSquadSelection(squadId)" class="remove-squad">√ó</button>
                    </span>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <div class="form-actions">
            <button type="button" class="btn btn-secondary" (click)="hideCreateReleaseForm()">
              Cancelar
            </button>
            <button
              type="submit"
              class="btn btn-primary"
              [disabled]="!releaseForm.form.valid || creating"
            >
              {{ creating ? 'Criando...' : 'Criar Release' }}
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- System Status -->
    <div class="system-status">
      <h2>Status do Sistema</h2>
      <div class="status-grid">
        <div class="status-card">
          <div class="status-header">
            <h3>API Backend</h3>
            <span class="status-indicator" [class]="apiStatus ? 'online' : 'offline'">
              {{ apiStatus ? 'üü¢ Online' : 'üî¥ Offline' }}
            </span>
          </div>
          <button class="btn btn-secondary" (click)="checkApiStatus()">Verificar</button>
        </div>
        
        <div class="status-card">
          <div class="status-header">
            <h3>Banco de Dados</h3>
            <span class="status-indicator" [class]="dbStatus ? 'online' : 'offline'">
              {{ dbStatus ? 'üü¢ Conectado' : 'üî¥ Desconectado' }}
            </span>
          </div>
          <button class="btn btn-secondary" (click)="checkDbStatus()">Verificar</button>
        </div>
      </div>
    </div>

    <!-- Messages -->
    <div *ngIf="message" class="alert" [class]="messageType">
      {{ message }}
    </div>
  </div>
</div>

